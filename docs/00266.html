<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>Building the Application</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '00266.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00266.html" target="topic">Building the Application</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony TCP/IP Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="01697.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="00265.html" target="topic">Previous</a> | <a href="00267.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: APPS TCPIP USB FATFS Build Topic Title: Building the Application)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Building the Application</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
The following table lists the MPLAB X projects available for this demonstration. These projects are available inside &lt;install-dir&gt;/net/apps/web_ftp_server_usb_fatfs/firmware.&nbsp;</p>
<p class="Element10">
To build this project, open the &lt;project name&gt;.X project in MPLAB X IDE.&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="8%">
<div class="Element66">
Project Name&nbsp;</div></td><td class="Element65" valign="top" width="6%">
<div class="Element66">
Target Device&nbsp;</div></td><td class="Element65" valign="top" width="11%">
<div class="Element66">
Target Development Board&nbsp;</div></td><td class="Element65" valign="top" width="75%">
<div class="Element66">
Description&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="8%">
<div class="Element68">
sam_e54_xpro.X&nbsp;</div></td><td class="Element67" valign="top" width="6%">
<div class="Element68">
ATSAME54P20A&nbsp;</div></td><td class="Element67" valign="top" width="11%">
<div class="Element68">
SAME54 Xplained Pro&nbsp;</div></td><td class="Element67" valign="top" width="75%">
<div class="Element68">
Demonstrates the TCP/IP Web Server with USB Host_layer , MSD class driver and the MPLAB Harmony File System FS on a development board with ATSAME54P20A device and on-board KSZ8091 PHY. This is a bare-metal (non-RTOS) implementation.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="8%">
<div class="Element68">
sam_e54_xpro_freertos.X&nbsp;</div></td><td class="Element67" valign="top" width="6%">
<div class="Element68">
ATSAME54P20A&nbsp;</div></td><td class="Element67" valign="top" width="11%">
<div class="Element68">
SAME54 Xplained Pro&nbsp;</div></td><td class="Element67" valign="top" width="75%">
<div class="Element68">
Demonstrates the TCP/IP Web Server with USB Host_layer , MSD class driver and the MPLAB Harmony File System FS on a development board with ATSAME54P20A device and on-board KSZ8091 PHY. This implementation is based on FreeRTOS.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
The following Project Graph diagram shows the Harmony components included in the bare-metal TCP/IP Web Server with USB Host_layer , MSD class driver and the MPLAB Harmony File System demonstration application.&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>Root project graph with TCPIP stack , USB Host_layer , MSD class driver and the MPLAB Harmony File System –</strong>&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_project_configuration.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>File system component configuration for this application to use USB HOST media –</strong>&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_filesystemWithUSBMedia.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>NOTE – “USB Full Speed Driver” , “ Host Layer” and “MSD Client Driver” use the default configuration.</strong>&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>HTTP server with Web directory Mount path and Http port number configuration -</strong>&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_HTTP_Server_configuration.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
<strong>FTP server with Root directory Mount Path and Run time authentication –</strong>&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_FTP_Server_configuration.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>USB HOST Pin Configurations –</strong>&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_usbHost_pin_configurations.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>Clock Configuration –</strong>&nbsp;</p>
<p class="Element10">
The USB application would need 48MHz clock for functioning. The FDPLL0 will be configured to generate 96MHz for the CPU and divide it using one of the GCLK generators to generate the 48MHz clock needed by the USB Controller. Steps to be followed are as given below:&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_clock_configuration.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
1. Enable the External Multipurpose Crystal Oscillator1 (<strong>XOSC1</strong>) needed as reference for <strong>FDPLL</strong>. Check the boxes and select <strong>CRYSTAL</strong> from the drop box. The output of <strong>XOSC1</strong> shows <strong>12MHz</strong>.&nbsp;</p>
<p class="Element10">
2. Select <strong>GCLK Generator 1</strong> set to run, select <strong>XOSC1</strong> and select the divider 12 to generate <strong>GCLK1</strong> output with <strong>1MHz</strong> .&nbsp;</p>
<p class="Element10">
3. Enable the <strong>FDPLL0</strong> by selecting the check box from the <strong>Fractional Digital Phase Lock Loop</strong> and select <strong>GCLK1</strong> with <strong>GCLK_DPLL</strong> as the clock source. The output of the <strong>FDPLL0</strong> should be <strong>120MHz</strong>.&nbsp;</p>
<p class="Element10">
4. Similarly enable the <strong>FDPLL1</strong> by selecting the check box from the Fractional Digital Phase Lock Loop and select <strong>GCLK1</strong> with <strong>GCLK_DPLL</strong> as the clock source. The desired <strong>FDPLL1</strong> output frequency <strong>96MHz</strong>.&nbsp;</p>
<p class="Element10">
5. Click Auto Calculate to show the <strong>FDPLL</strong> Auto Settings Calculation. Select the desired <strong>FDPLL</strong> output frequency (<strong>96MHz</strong>).&nbsp;</p>
<p class="Element10">
6. Select the <strong>FDPLL0</strong> as source clock for <strong>GCLK0</strong>.&nbsp;</p>
<p class="Element10">
7. Select <strong>GCLK</strong> Generator x only for <strong>GCLK2</strong> to run with <strong>FDPLL1</strong> as the input source with <strong>Clock Divider</strong> value to 2. This generated output <strong>48MHz</strong> will be used for the USB device.&nbsp;</p>
<p class="Element10">
8. Open Peripheral Clock Configuration and select <strong>GCLK2</strong> for <strong>USB</strong>. Ensure that the peripheral clock frequency should be <strong>48MHz</strong>.&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<img src="APPS_TCPIP_USB_peripheral_clock_configuration.png" border="0" alt="" title="">&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
<strong>Configuration packs for the SAME54 –</strong>&nbsp;</p>
<p class="Element10">
SAME54_DFP = v3.3.64&nbsp;</p>
<p class="Element10">
CMSIS = v5.4.0</p></div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00266.html" target="topic">Building the Application</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB Harmony TCP/IP Help</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="01697.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="00265.html" target="topic">Previous</a> | <a href="00267.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: APPS TCPIP USB FATFS Build Topic Title: Building the Application)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>