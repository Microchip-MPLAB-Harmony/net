<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="TCPIP_MDNS_ServiceRegister Function" />
<meta name="DC.relation" scheme="URI" content="GUID-1076C2EA-7DC5-419E-A3E7-BBA92CFF5CFB.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="tcpip-mdns-serviceregister-function" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>TCPIP_MDNS_ServiceRegister Function</title>
<meta name="Microsoft.Help.Id" content="GUID-B1AF6B2B-BC62-4D92-B329-A50140DF3437-tcpip-mdns-serviceregister-function" />
<meta name="Microsoft.Help.TocParent" content="GUID-B1AF6B2B-BC62-4D92-B329-A50140DF3437" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLABÂ® Harmony TCP/IP Library Reference A 10/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-8AE11F4C-45C5-4D5D-91FA-DC93DCFAAF74"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="tcpip-mdns-serviceregister-function">
<h1 class="title topictitle1" id="ariaid-title1">TCPIP_MDNS_ServiceRegister Function</h1><div class="body"></div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-1076C2EA-7DC5-419E-A3E7-BBA92CFF5CFB.html">Zeroconf Module</a></div>
</div>
</div><div class="topic nested1" aria-labelledby="ariaid-title2" id="c"><h2 class="title topictitle2" id="ariaid-title2">C</h2><div class="body"><pre class="pre codeblock"><button title="Copy Code" class="copy-code" onclick="cpy('d208890e21', this);">Copy</button><code id="d208890e21" content="MDNSD_ERR_CODE TCPIP_MDNS_ServiceRegister(&#xD;&#xA;    TCPIP_NET_HANDLE netH, &#xD;&#xA;    const char * srv_name, &#xD;&#xA;    const char * srv_type, &#xD;&#xA;    uint16_t port, &#xD;&#xA;    const uint8_t * txt_record, &#xD;&#xA;    uint8_t auto_rename, &#xD;&#xA;    void (*call_back)(char *name, MDNSD_ERR_CODE err, void *context), &#xD;&#xA;    void * context&#xD;&#xA;);&#xD;">MDNSD_ERR_CODE TCPIP_MDNS_ServiceRegister(&#xD;
    TCPIP_NET_HANDLE netH, &#xD;
    const char * srv_name, &#xD;
    const char * srv_type, &#xD;
    uint16_t port, &#xD;
    const uint8_t * txt_record, &#xD;
    uint8_t auto_rename, &#xD;
    void (*call_back)(char *name, MDNSD_ERR_CODE err, void *context), &#xD;
    void * context&#xD;
);&#xD;</code></pre></div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title3" id="description"><h2 class="title topictitle2" id="ariaid-title3">Description</h2><div class="body"><p class="p">This function is used by end-user application to announce its service on local network. All peer machines that are compliant with Multicast DNS and DNS Service Discovery protocol can detect the announcement and lists out an entry in the Service Browser list. The end-user selects an entry to connect to this service. Ultimately this is an aid to end-user to discover any service of interest on a local network.</p>
<p class="p">This is the first function that needs to be invoked by end-user application. Presently Multicast-DNS and Service discovery stack supports only single service advertisement. Once the application wants to terminate the service it has to invoke TCPIP_MDNS_ServiceDeregister() function to free the DNS SD stack for some other application.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title4" id="preconditions"><h2 class="title topictitle2" id="ariaid-title4">Preconditions</h2><div class="body"><p class="p">None.</p>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title5" id="parameters"><h2 class="title topictitle2" id="ariaid-title5">Parameters</h2><div class="body">
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d208890e47"><span>Parameters</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d208890e49"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>netH</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Handle of the network to be registered.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>srv_name</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Service name, which is being advertised.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>srv_type</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>For a HTTP-Service it's "__http._tcp.local".</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>__http</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Application protocol proceeded with an underscore.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>_tcp</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Lower-layer protocol on which service runs.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>local</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>To represent service is on local-network. For iTunes Music Sharing "_daap._tcp.local" For a Printing Service "_ipp._tcp.local" Refer to http://www.dns-sd.org/ServiceTypes.html for more service types.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>port</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Port number on which service is running.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>txt_len</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>For additional information about service like default page (e.g., "index.htm") for HTTP-service. Length of such additional information.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>txt_record</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>String of additional information (e.g., "index.htm") for HTTP service.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>auto_rename</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>A flag to indicate DNS-SD stack, whether to rename the service automatically or not. If this is set to '0' Callback parameter will be used to indicate the conflict error and user has to select different name and re-register with this function. If this is set to '1' service-name will be automatically renamed with numerical suffix.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>callback</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Callback function, which is user-application defined. This callback gets invoked on completion of service advertisement. If an service name-conflict error is detected and auto_rename is set to '0' callback gets invoked with MDNSD_ERR_CONFLICT as error-code.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e47 "><span>context</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d208890e49 "><span>Opaque context (pointer to opaque data), which needs to be used in callback function.</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="topic nested1" aria-labelledby="ariaid-title6" id="returns"><h2 class="title topictitle2" id="ariaid-title6">Returns</h2><div class="body"><ul class="ul"><li class="li"><p class="p">MDNSD_ERR_CODE - Returns Error-code to indicate whether or not registration is successful:</p>
<ul class="ul"><li class="li"><p class="p">MDNSD_SUCCESS - returns on success of call.</p>
</li>
<li class="li"><p class="p">MDNSD_ERR_BUSY - When already some other service is being advertised using this DNS SD stack.</p>
</li>
<li class="li"><p class="p">MDNSD_ERR_INVAL - Invalid parameter.</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
</body>
</html>