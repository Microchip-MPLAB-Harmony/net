<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="topic" />
<meta name="DC.title" content="DHCP Server Module" />
<meta name="DC.relation" scheme="URI" content="GUID-01A0A1D8-EC9B-4EFF-B8E4-D154B555FEF2.html" />
<meta name="DC.relation" scheme="URI" content="GUID-088770E9-EA3A-4AEA-A328-D70523609360.html" />
<meta name="DC.relation" scheme="URI" content="GUID-CC0DE8A5-7934-4838-97B7-59137819501A.html" />
<meta name="DC.relation" scheme="URI" content="GUID-C4CD3F53-E57A-4E19-A8BA-ED96180C8ED1.html" />
<meta name="DC.relation" scheme="URI" content="GUID-57290915-F64F-4FA3-80F5-3F61074D86BA.html" />
<meta name="DC.relation" scheme="URI" content="GUID-21001124-9CE0-4D32-B195-ED3B69AEF28A.html" />
<meta name="DC.relation" scheme="URI" content="GUID-AB42E2A0-98A7-4AC7-BCD8-4FEBAD6FD2FD.html" />
<meta name="DC.relation" scheme="URI" content="GUID-1E64BC34-AD66-494E-B1DD-CB0B4715145A.html" />
<meta name="DC.relation" scheme="URI" content="GUID-14BB0D8F-F47E-45B7-B70B-DA689313D9D7.html" />
<meta name="DC.relation" scheme="URI" content="GUID-4D83D14D-F726-4FE8-B61E-17E9CB9C92AC.html" />
<meta name="DC.relation" scheme="URI" content="GUID-7331FDCC-3800-490B-9496-10202260E785.html" />
<meta name="DC.relation" scheme="URI" content="GUID-6AB7C2A7-4C32-4E18-9204-F39B1365EF4C.html" />
<meta name="DC.relation" scheme="URI" content="GUID-49B5D6B0-6CA1-4B6B-894B-88324C6E48CF.html" />
<meta name="DC.relation" scheme="URI" content="GUID-6BA9DFB7-8062-4262-8751-6D45D3CF21E4.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="dhcp-server-module" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>DHCP Server Module</title>
<meta name="Microsoft.Help.Id" content="GUID-B1AF6B2B-BC62-4D92-B329-A50140DF3437-dhcp-server-module" />
<meta name="Microsoft.Help.TocParent" content="GUID-B1AF6B2B-BC62-4D92-B329-A50140DF3437" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB® Harmony TCP/IP Library Reference A 10/2021" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-27C514CD-DE28-4215-BB75-6C8EA971E12E"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="dhcp-server-module">
<h1 class="title topictitle1" id="ariaid-title1">DHCP Server Module</h1><div class="body"><p class="p">The DHCP Server module is used to assign IP addresses to DHCP clients from the configured IP address database. When the server receives a request from a client, the DHCP server determines the network to which the DHCP client is connected, and then allocates an IP address that is appropriate for the client, and sends configuration information appropriate for that client. DHCP servers typically grant IP addresses to clients only for a limited interval. DHCP clients are responsible for renewing their IP address before that interval has expired, and must stop using the address once the interval has expired, if they have not been able to renew it.</p>
<p class="p"><strong class="ph b">Abstraction Model</strong></p>
<p class="p">This module provides software abstraction of the DHCP Server module existent in any TCP/IP Stack implementation. It removes the overhead of address resolution from all other modules in the stack</p>
<br /><img class="image" src="GUID-90A7B2F8-7623-4629-99D5-AC3CF1A5C39D-low.png" alt="dhcp_diagram1" /><br /><p class="p"><strong class="ph b">How the Library Works</strong></p>
<p class="p">To use DHCP Server, include the files dhcps.c, and dhcps.h in your project, and add or uncomment the definition "#define TCPIP_STACK_USE_DHCP_SERVER" to tcpip_config.h.</p>
<p class="p">The DHCP Server module will assign IP addresses to DHCP clients from the configured IP address database.</p>
<p class="p">When the server receives a request from a client, the DHCP server allocates an IP address that is appropriate for the client, and sends configuration information appropriate for that client.</p>
<p class="p">The IP addresses will be granted for a limited interval. DHCP clients are responsible for renewing their IP address before that interval has expired.</p>
<p class="p">A DHCP client must stop using the leased address once the interval has expired, if they have not been able to renew it.</p>
<p class="p"><strong class="ph b">Library Interface</strong></p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" class="table" frame="border" border="1" rules="all"><col style="width:" /><col style="width:" /><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder" style="vertical-align:middle;" id="d105891e43"><span>Name</span></th>
<th class="entry cellrowborder" style="vertical-align:middle;" id="d105891e45"><span>Description</span></th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span><strong class="ph b">Macros</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span> </span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_DEFAULT_IP_ADDRESS_RANGE_START</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>These below IPv4 DHCP server address details are default address and it is assigned to the network default network interface. for Other interfaces , tcpip_stack_init.c file should be use to configure DHCP_POOL_CONFIG<span class="xref"></span>. IPv4 Address range is starting from 100, because the from 1 to 100 is reserved. Reserved Address will be used for the gateway address. Start of IP address Range , network_config.h ipaddress and this start of IP address should be in same SUBNET RECOMENDED - network_config.h ipaddress should be 192.168.1.1 if DHCP server ip address range starts from 192.168.1.100.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_DEFAULT_SERVER_IP_ADDRESS</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server Address per interface. DHCP server Address selection should be in the same subnet.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_DEFAULT_SERVER_NETMASK_ADDRESS</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server subnet Address per interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_DEFAULT_SERVER_PRIMARY_DNS_ADDRESS</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server DNS primary Address</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_DEFAULT_SERVER_SECONDARY_DNS_ADDRESS</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server DNS Secondary Address</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_DURATION</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Timeout for a solved entry in the cache, in seconds the entry will be removed if the TMO elapsed and the entry has not been referenced again</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_ENTRIES_DEFAULT</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>The Maximum Number of entries in the lease table Default total number of entries for all the the interface</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_REMOVED_BEFORE_ACK</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Timeout for a unsolved entry , in seconds and should be removed from the entry if there is no REQUEST after OFFER</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_SOLVED_ENTRY_TMO</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Timeout for a solved entry in the cache, in seconds. The entry will be removed if the TMO lapsed and the entry has not been referenced again</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_TASK_PROCESS_RATE</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCPS task processing rate, in milliseconds. The DHCPS module will process a timer event with this rate for maintaining its own queues, processing timeouts, etc. Choose it so that the other TMO are multiple of this The default value is 200 milliseconds. The lower the rate (higher the frequency) the higher the module priority and higher module performance can be obtained The value cannot be lower than the TCPIP_STACK_TICK_RATE.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>###Configuration</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Functions</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_Disable</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Disables the DHCP Server for the specified interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_Enable</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Enables the DHCP Server for the specified interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_RemovePoolEntries</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Removes all the entries or only used entries of a certain type belonging to a network interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span><strong class="ph b">Status Functions</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span> </span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_IsEnabled</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Determines if the DHCP Server is enabled on the specified interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_GetPoolEntries</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Get all the entries or only used entries of a certain type belonging to a network interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LeaseEntryGet</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Get the lease entry details as per TCPIP_DHCPS_LEASE_HANDLE and per interface.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span><strong class="ph b">Data Types and Constants</strong></span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span> </span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_ENTRY</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP Server module lease data.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LEASE_HANDLE</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP Server Lease Handle</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_POOL_ENTRY_TYPE</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server pool types are used to get and remove the leased IP address details.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_ADDRESS_CONFIG</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP server configuration and IP address range.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_MODULE_CONFIG</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>DHCP Server module runtime and initialization configuration data.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_LeaseEntryRemove</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Remove one entry from the DHCP server leased entry.</span></td>
</tr>
<tr class="row"><td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e43 "><span>TCPIP_DHCPS_Task</span></td>
<td class="entry cellrowborder" style="vertical-align:middle;" headers="d105891e45 "><span>Standard TCP/IP stack module task function.</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="related-links">
<ul class="ullinks">
<li class="link ulchildlink"><strong><a href="GUID-088770E9-EA3A-4AEA-A328-D70523609360.html">TCPIP_DHCPS_ADDRESS_CONFIG Structure</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-CC0DE8A5-7934-4838-97B7-59137819501A.html">TCPIP_DHCPS_Disable Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-C4CD3F53-E57A-4E19-A8BA-ED96180C8ED1.html">TCPIP_DHCPS_Enable Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-57290915-F64F-4FA3-80F5-3F61074D86BA.html">TCPIP_DHCPS_GetPoolEntries Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-21001124-9CE0-4D32-B195-ED3B69AEF28A.html">TCPIP_DHCPS_IsEnabled Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-AB42E2A0-98A7-4AC7-BCD8-4FEBAD6FD2FD.html">TCPIP_DHCPS_LEASE_ENTRY Structure</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-1E64BC34-AD66-494E-B1DD-CB0B4715145A.html">TCPIP_DHCPS_LEASE_HANDLE Type</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-14BB0D8F-F47E-45B7-B70B-DA689313D9D7.html">TCPIP_DHCPS_LeaseEntryGet Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-4D83D14D-F726-4FE8-B61E-17E9CB9C92AC.html">TCPIP_DHCPS_LeaseEntryRemove Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-7331FDCC-3800-490B-9496-10202260E785.html">TCPIP_DHCPS_MODULE_CONFIG Structure</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-6AB7C2A7-4C32-4E18-9204-F39B1365EF4C.html">TCPIP_DHCPS_POOL_ENTRY_TYPE Enumeration</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-49B5D6B0-6CA1-4B6B-894B-88324C6E48CF.html">TCPIP_DHCPS_RemovePoolEntries Function</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-6BA9DFB7-8062-4262-8751-6D45D3CF21E4.html">TCPIP_DHCPS_Task Function</a></strong><br />
</li>
</ul>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-01A0A1D8-EC9B-4EFF-B8E4-D154B555FEF2.html">MPLAB® Harmony TCP/IP Library</a></div>
</div>
</div></body>
</html>