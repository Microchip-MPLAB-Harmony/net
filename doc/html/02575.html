<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>TCPIP_ICMP_CallbackRegister Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '02575.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00951.html" target="topic">TCP/IP Stack Libraries Help</a> &gt; <a href="00708.html" target="topic">ICMP Module</a> &gt; <a href="01453.html" target="topic">Library Interface</a> &gt; a) Functions &gt; <a href="02575.html" target="topic">TCPIP_ICMP_CallbackRegister Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony TCP/IP Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="01504.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="02574.html" target="topic">Previous</a> | <a href="01453.html" target="topic">Up</a> | <a href="02585.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: TCPIP_ICMP_CallbackRegister@void *callbackTCPIP_NET_HANDLE hNetIf, IPV4_ADDR * remoteIP, void * data Topic Title: TCPIP_ICMP_CallbackRegister Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
TCPIP_ICMP_CallbackRegister Function</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Allows a stack client to be notified of the receiving of a response from an ICMP query. Once an Echo request reply is received, the notification handler callback will be called, letting the client know of the result of the query. The callback will contain as parameters:</p>
<ul class="Element630">
<li class="Element600">the network interface handle on which the query reply was received</li>
<li class="Element600">the remote host IP address</li>
<li class="Element600">a 32-bit value containing the sequence number in the low 16-bit part and the identifier value in the high 16-bit part.</li>
</ul></div>
</div>
<a name="43"></a><div class="Element99">
C</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><a href="00719.html" target="topic">ICMP_HANDLE</a> <strong><span style="color: #000000">TCPIP_ICMP_CallbackRegister</span></strong>(
    <strong><span style="color: #000080">void</span></strong> (*callback)(<a href="03055.html" target="topic">TCPIP_NET_HANDLE</a> hNetIf, IPV4_ADDR * remoteIP, <strong><span style="color: #000080">void</span></strong> * data)
);</pre></div></div>
<a name="507265636F6E646974696F6E73"></a><div class="Element14">
Preconditions</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
The TCP/IP Stack must be initialized and up and running.</p></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
Parameters</div>
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table3">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Parameters&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
callback&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
notification function to be registered. This function will be called when an echo request reply is received.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
Returns</div>
<div class="Element11">
<div class="Element10">

<ul class="Element630">
<li class="Element600">A non-null handle if the registration succeeded</li>
<li class="Element600">0 if the registration operation failed (for example, out of memory)</li>
</ul></div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
Remarks</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
None.</p></div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
Example</div>
<div class="Element11">
<div class="Element10">
<div class="Element13"><div class="Element12"><pre class="Element12">  <i><span style="color: #008000">// Callback function prototype</span></i>
  <strong><span style="color: #000080">void</span></strong> MyICMPCallbackFunction(<a href="03055.html" target="topic">TCPIP_NET_HANDLE</a> hNetIf, IPV4_ADDR * remoteIP, <strong><span style="color: #000080">void</span></strong> * data);

  <i><span style="color: #008000">// *****************************************************************************</span></i>
  <i><span style="color: #008000">// Register callback function</span></i>
  <a href="00719.html" target="topic">ICMP_HANDLE</a> hIcmp = TCPIP_ICMP_CallbackRegister(&amp;MyICMPCallbackFunction);
  <strong><span style="color: #000080">if</span></strong>(hIcmp == 0)
  {
      <i><span style="color: #008000">// process error; couldn't register a handler</span></i>
  }

  <i><span style="color: #008000">// success; I can send an Echo request and receive notification</span></i>


  <i><span style="color: #008000">// *****************************************************************************</span></i>
  IPV4_ADDR remoteIP = 0xc0a00101;
  uint16_t mySequenceNumber = 1;
  uint16_t myId = 0x1234;
  <i><span style="color: #008000">// send an ICMP query request</span></i>
  <a href="02585.html" target="topic">TCPIP_ICMP_EchoRequestSend</a>(&amp;remoteIP, mySequenceNumber, myId);


  <i><span style="color: #008000">// *****************************************************************************</span></i>
  <i><span style="color: #008000">// process the ICMP reply in the callback function</span></i>
  <strong><span style="color: #000080">void</span></strong> MyICMPCallbackFunction(<a href="03055.html" target="topic">TCPIP_NET_HANDLE</a> hNetIf, IPV4_ADDR * remoteIP, <strong><span style="color: #000080">void</span></strong> * data)
  {
      <i><span style="color: #008000">// process request from interface hNetIf and remoteIP address</span></i>
      uint16_t* pReply = (uint16_t*)data;
      uint16_t myRecvId = *pReply;
      uint16_t myRecvSequenceNumber = *(pReply + 1);

      <i><span style="color: #008000">// check that the sequence number, ID and IP address match, etc.</span></i>
  }</pre></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00951.html" target="topic">TCP/IP Stack Libraries Help</a> &gt; <a href="00708.html" target="topic">ICMP Module</a> &gt; <a href="01453.html" target="topic">Library Interface</a> &gt; a) Functions &gt; <a href="02575.html" target="topic">TCPIP_ICMP_CallbackRegister Function</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB Harmony TCP/IP Help</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="01504.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="02574.html" target="topic">Previous</a> | <a href="01453.html" target="topic">Up</a> | <a href="02585.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: TCPIP_ICMP_CallbackRegister@void *callbackTCPIP_NET_HANDLE hNetIf, IPV4_ADDR * remoteIP, void * data Topic Title: TCPIP_ICMP_CallbackRegister Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>